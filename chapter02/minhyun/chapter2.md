# 1. 영화 예매 시스템

## 요구사항

- 상태와 행동으로 객체를 생각해보는 것이 중요.
- 할인 정책은 두 가지 규칙으로 나눌 수 있다.
    - 할인 조건(discount condition)
        - 가격의 할인 여부를 결정, 두 조건으로 나눌 수 있음
            - 순서조건: 상영 순번을 이용해 할인 여부를 결정
            - 기간 조건: 상영 시작 시간을 이용해 할인 여부를 결정
    - 할인 정책(discount policy)
        - 할인 요금을 결정, 두 조건으로 나눌 수 있음
            - 금액 할인 정책: 예매 요금에서 일정 금액을 할인
            - 비율 할인 정책: 정가에서 일정 비율의 요금을 할인
    - 영화별로 최대 하나의 할인 정책을 지정 가능, 할인 조건은 다수 지정 가능

---

# 2. 객체지향 프로그래밍을 향해

- 진정한 객체지향 패러다임으로의 전환은 **클래스가 아닌 객체에 초첨을 맞출 때 얻을 수 있다.**
    1. 클래스를 먼저 고민하기보다 어떤 객체들이 필요한지 고민하라.
    2. 객체는 독립적인 존재가 아니라 기능을 구현하기 위한 협력 공동체의 일원으로 보자.
    
- 사용자가 프로그램을 사용하는 분야를 **도메인**이라고 한다.
- 클래스의 경계를 구분 짓는 것이 가장 중요하다. (외부 공개, 감추는 부분 결정)
    - 경계의 명확성이 객체의 자율성을 보장하기 때문

- 객체지향에서 중요한 개념은 ‘상속’ 과 ‘다형성’ 이다.
    - 해당 기반에는 ‘추상화’ 라는 원리가 숨겨져 있다.

---

### 자율적인 객체

1. 객체는 상태(state)와 행동(behavior)을 함께 가지는 복합적인 존재이다.
2. 스스로 판단하고 행동하는 자율적인 존재이다.

객체지향 이전에서는 ‘데이터’와 ‘기능’ 이라는 독립적인 존재를 서로 엮어 프로그램을 구성했다면, 객체지향은 객체라는 단위 안에 데이터와 기능을 한 덩어리로 묶어 캡슐화 시킨다.

### 캡슐화와 접근제어가 객체를 나누는 두부분

1. 퍼블릭 인터페이스
    1. 외부에서 접근 가능
2. 구현
    1. 내부에서만 접근 가능하여 구현 은닉 가능

인터페이스와 구현의 분리 원칙은 객체 지향 핵심 원칙이다.

### 협력

- 객체들 사이에 이뤄지는 상호작용
    - 상호작용 할 수 있는 방법은 ‘메시지를 전송’ 하는 것 뿐인데, 이런 메시지를 처리하기 위한 방법을 ‘메서드’라고 부른다.
    - 메시지와 메서드를 구분하는 것은 매우 중요하며, 해당 구분에서부터 ‘다형성’이라는 개념이 출발함
- 부모 클래스에 기본적인 알고리즘의 흐름을 구현하고, 중간에 필요한 처리를 자식 클래스에게 위임하는 디자인 패턴을 `TEMPLATE_METHOD_패턴` 이라고 부른다.

---

# 4. 상속과 다형성

- 확장 가능한 객체지향 설계가 가지는 특징은 코드의 의존성과 실행시점의 의존성이 다르다는 것
    - 의존성의 양면성 → 설계란 트레이드 오프의 산물이라는 사실을 알려줌
        - 단점: 다를수록 코드를 이해하기 어려워진다. → 객체를 생성하고 연결하는 부분을 찾아야 하기 때문
        - 장점: 다를수록 코드는 유연해지고 확장가능해진다.

## 상속

- 기존 클래스를 기반으로 새로운 클래스를 쉽고 빠르게 추가할 수 있는 방법 제공
- 코드 중복을 제거하고 여러 클래스 사이에서 동일한 코드 공유 가능
- 자식 클래스가 부모 클래스의 타입으로 변환되는 것을 ‘업캐스팅’ 이라고 부른다.

→ 부모 클래스와 다른 부분만을 추가하여 새 클래스를 쉽고 빠르게 만드는 방법을 **‘차이에 의한 프로그래밍(programming by difference)’** 라고 부른다.

### 다형성

→ 동일한 메시지 수신 시, 객체의 타입에 따라 다르게 응답할 수 있는 능력 

- **⇔** 지연(lazy) 바인딩, 동적(dynamic) 바인딩
- ≠ 초기(early) 바인딩, 정적(static) 바인딩

- 객체지향 프로그램의 컴파일 시간 의존성과 실행 시간 의존성이 다를 수 있다는 사실을 기반으로 함.
    - 해당 특성을 이용하여 서로 다른 메서드를 실행할 수 있게 함.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/34ea7cb7-d202-4e90-926d-07b7bc241167/213485d1-2737-4aca-a5ca-175e0ff1db7a/Untitled.png)

### 인터페이스와 다형성

추상클래스와 달리 구현을 공유할 필요가 없을 경우 인터페이스를 이용해 다형적 협력 참여 가능.

# 5. 추상화와 유연성

같은 계층에 속하는 클래스들이 공통으로 가질 수 있는 인터페이스를 정의하며 구현의 일부(추상) 또는 전체(인터페이스) 를 자식 클래스가 결정할 수 있도록 결정권을 위임함.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/34ea7cb7-d202-4e90-926d-07b7bc241167/a63a45dc-0a93-408c-ba33-74582022f0c7/Untitled.png)

자식 클래스를 생략한 코드 구조를 그림으로 표현. 추상화의 두가지 장점을 보여준다.

1. 추상화 계층만 살펴보면 요구사항의 정책을 높은 수준에서 서술할 수 있음.
    - 여러 세부적인 문장을 큰 틀로 포괄할 수 있다 → 세부사항에 관계없이 상위 개념만으로 도메인의 중요 개념을 설명할 수 있다.
    - 상위 협력 흐름을 그대로 따를 수 있다. → 재사용이 가능
2. 추상화를 이용하면 설계가 좀 더 유연해짐.
    - 기존 구조를 수정하지 않고도 새 기능을 쉽게 추가하고 확장할 수 있다.

## 유연한 설계

책임의 위치를 결정하기 위해 조건문을 사용하는 것은 대부분 좋지 않다. → 하지만 어쩔수없죠…

항상 예외 케이스를 최소화하고 일관성을 유지할 수 있는 방법을 선택하라.

*** **내가 작성하는 모든 코드에는 합당한 이유가 있어야한다. 고민하고 트레이드 오프하라** ***

## 코드 재사용

- 상속보다는 합성(composition)이 더 좋은 방법이다.
    - 합성 → 다른 객체의 인스턴스를 자신의 인스턴스 변수로 포함해서 재사용 하는 방법

### 상속

**단점**

1. 캡슐화를 위반함
    - 상속을 이용하기 위해선 부모 클래스의 내부 구조를 알아야 함
        
        → 구현이 자식 클래스에게 노출되어 캡슐화가 약화됨 
        
        → 캡슐화 약화는 서로 강하게 결합되도록 만들어 부모 클래스 변경시 자식 클래스도 함께 변경될 확률을 높임.
        
2. 설계를 유연하지 못하게 만듬
    - 부모와 자식 관계를 컴파일 시점에 결정하여 실행 시점에 객체 종류 변경이 불가능함.

### 합성

- 인터페이스에 정의된 메시지를 통해서만 코드를 재사용 하는 방법

**상속의 문제점 해결**

1. 인터페이스에 정의된 메시지를 통해서만 재사용 가능하여 구현을 효과적으로 캡슐화 가능
2. 의존하는 인스턴스 교체가 쉬워 설계를 유연하게 함.

*** 객체지향 설계의 핵심은 적절한 협력을 식별하고 협력에 필요한 역할을 정의한 후에 역할을 수행할 수 있는 적절한 객체에게 적절한 책임을 할당하는 것 ***