# 5장 - 책임 할당하기

# 책임 주도 설계를 향해

데이터 중심 설계에서 책임 중심의 설계로 전환하기 위해서는 다음의 두 가지 원칙을 따라야 한다.

- 데이터보다 행동을 먼저 결정하라
- 협력이라는 문맥 안에서 책임을 결정하라

## 데이터보다 행동을 먼저 결정하라

- 객체에게 중요한 것은 데이터가 아니라 외부에 제공하는 행동
- 데이터는 객체가 책임을 수행하는데 필요한 재료를 제공할 뿐
- 책임 중심의 설계에서는 책임을 먼저 결정한 후에 책체의 상태를 결정한다는 것

## 협력이라는 문맥 안에서 책임을 결정하라

협력에 적합한 책임을 수확하기 위해서는 객체를 결정한 후에 메시지를 선택하는 것이 아니라 메시지를 결정한 후에 객체를 선택해야 한다. 객체가 메시지를 선택하는 것이 아니라 메시지가 객체를 선택하게 해야 한다.

- 메시지는 클라이언트의 의도를 표현한다

# 책임 할당을 위한 GRASP 패턴

## 도메인 개념에서 출발하기

설계를 시작하는 단계에서는 개념들의 의미와 관계가 정확하거나 완벽할 필요가 없다. 이 단계에서는 책임을 할당받을 객체들의 종류와 관계에 대한 유용한 정보를 제공할 수 있다면 충분하다. 도메인 개념을 정리하는 데 너무 많은 시간을 들이지 말고 빠르게 설계와 구현을 진행하라.

## 정보 전문가에게 책임을 할당하라

메시지는 메시지를 수신할 객체가 아니라 메시지를 전송할 객체의 의도를 반영해서 결정해야 한다.

- 메시지를 전송할 객체는 무엇을 원하는가?
    - 예매하라
- 메시지를 수신할 적합한 객체는 누구인가?

책임을 수행할 정보를 알고 있는 객체에게 책임을 할당하는 패턴을 정보 전문가 패턴이라고 한다.

## 높은 응집도와 낮은 결합도

설계는 트레이드 오프의 영역이지만 책임을 할당할 수 있는 다양한 대안들이 존재한다면 응집도와 결합도의 측면에서 더 나은 대안을 선택하는 것이 좋다. 이를 낮은 결합도 패턴과 높은 응집도 패턴이라고 부른다.

## 창조자에게 객체 생성 책임을 할당하라

객체를 생성해야 할 때 어떤 객체에게 객체 생성 책임을 할당해야 하는가? 아래 조건을 최대한 많이 만족하는 객체에게 객체 생성 책임을 할당하라.

- 객체를 포함하거나 참조한다
- 객체를 기록한다
- 객체를 긴밀하게 사용한다
- 객체를 초기화하는 데 필요한 데이터를 가지고 있다.

창조자 패턴은 이 같은 경우에 사용할 수 있는 책임 할당 패턴으로서 객체를 생성할 책임을 어떤 객체에게 할당할지에 대한 지침을 제공한다.

# 책임 주도 설계의 대안

빠르게 목적한 기능을 수행하는 코드를 작성 한 후 코드 상에 명확하게 드러나는 책임들을 올바른 위치로 이동시키는 방법. 이를 리팩터링이라고 부른다.

## 메서드 응집도

메서드가 변경되어야 하는 이유는 단 하나여야만 한다. 기존 코드를 개선했지만 여전히 클래스의 응집도는 낮다.

클래스의 응집도를 높이기 위해서는 변경의 이유가 다른 메서드들을 적절한 위치로 분배해야 한다.

## 객체를 자율적으로 만들자

객체가 자율적인 존재라는 뜻은 자신이 소유하고 있는 데이터를 자기 스스로 처리하도록 만드는 것이 자율적인 객체를 만드는 지름길. 할인 여부를 판단하는 메서드들은 DiscountCondition 객체로 옮기고 퍼블릭 인터페이스만 노출시키도록 하면 높은 응집도와 낮은 결합도륵 유지할 수 있다.