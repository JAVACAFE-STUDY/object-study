# 3장 : 역할, 책임, 협력

# 1. 객체지향 패러다임

### **핵심**

- 역할 ( role )
- 책임 ( responsibility )
- 협력 ( collaboration )

### 본질

- 협력하는 객체의 공동체를 창조하는 것
    - 객체지향 설계의 핵심은 **협력을 구성**하기 위해 적절한 **객체를 찾고 적절한 책임을 할당하는 과정**에서 드러난다.
    - 클래스와 상속은 객체들의 책임과 협력이 어느정도 자리를 잡은 후에 사용할 수 있는 구현 메커니즘일 뿐
    - 너무 이른 시기에 구현에 초점을 맞추면 변경하기 어렵고 유연하지 못한 코드를 낳을 수 있다.

⇒ 성급한 추상화가 가져오는 단점이 떠올랐다.

# 2. 협력, 책임, 역할

- **협력**
    - 객체들이 애플리케이션의 기능을 구현하기 위해 수행하는 상호작용
- **책임**
    - 객체가 협력에 참여하기 위해 수행하는 로직
- **역할**
    - 객체들이 협력 안에서 수행하는 책임들이 모여 객체가 수행하여 구성되는 것

## 협력

- 두 객체 사이의 협력은 하나의 객체가 다른 객체에게 도움을 요청할때 시작된다.
- **메시지 전송 ( message sending )** 은 객체 사이의 협력을 위해 사용할 수 있는 유일한 커뮤니케이션 수단이다.
    - 객체는 다른 객체의 내부 구현에 직접 접근할 수 없으므로 오직 메시지 전송을 통해서만 요청을 전달할 수 있다.
- 메시지를 수신한 객체는 메서드를 실행해 요청에 응답하는데, 여기서 중요한 점은 **객체가 메시지를 처리할 방법을 스스로 선택한다는** 것이다.
    - 이는 객체가 자신의 일을 스스로 처리할 수 있는 자율적인 존재라는 뜻

객체를 자율적으로 만드는 가장 기본적인 방법은 내부 구현을 **캡슐화** 하는 것이다.

캡슐화를 통해 변경에 대한 파급효과를 제한할 수 있기 때문에 자율적인 객체는 변경하기도 쉬워진다.

**객체의 행동을 결정하는 것**은 객체가 참여하고 있는 **협력**이다.

- 협력이 바뀌면 객체가 제공하는 행동도 바뀌어야 한다.
- 협력은 객체가 필요한 이유와 객체가 수행하는 행동의 동기를 제공한다.
    - 협력이 존재하기 때문에 객체가 존재하는 것

객체의 **상태**를 결정하는 것은 **행동**이다.

- 객체의 상태는 그 객체가 행동을 수행하는 데 필요한 정보가 무엇인지로 결정된다.
- 객체는 자신의 상태를 스스로 결정하고 관리하는 자율적인 존재이므로 행동에 필요한 상태도 함께 갖고 있어야 한다.

⇒ 협력을 통해, 객체의 행동을 결정하고 이렇게 수행한 행동이 객체의 상태를 결정 ( 협력 → 행동 → 상태 )순

결과적으로 협력이 객체를 구성하는 **행동**과 **상태**를 모두 결정한다.

- 협력이 객체를 설계하는 데 필요한 **문맥(context)** 을 제공한다.

## 책임

- 협력에 참여하기 위해 객체가 수행하는 행동

크레이그 라만(Craig Larman)은 책임을 크게 두 가지**(하는것 / 아는것 )**로 나눈다.

- **하는것 ( doing )**
    - 객체를 생성하거나 계산을 수행하는 등 스스로 하는 것
    - 다른 객체의 행동을 시작시키는 것
    - 다른 객체의 활동을 제어하고 조절하는 것
- **아는 것 ( knowing )**
    - 사적인 정보에 관해 아는 것
    - 관련된 객체에 관해 아는 것
    - 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것

일반적으로 책임과 메시지의 크기는 다르다.

- 책임은 객체가 수행할 수 있는 행동을 간략하게 서술하므로 메시지보다 추상적이고 개념적으로 크다.

책임의 관점에서 ‘아는 것’과 ‘하는 것’이 밀접하게 연관돼 있다.

- 객체는 자신이 맡은 책임을 수행하는 데 필요한 정보를 알고 있을 책임이 있다.
- 객체는 자신이 할 수 없는 작업을 도와줄 객체를 알고 있을 책임이 있다.
- 어떤 책임을 수행하기 위해선 그 책임을 수행하는 데 필요한 정보도 함께 알아야 할 책임이 있다는 것
- 이건 객체에게 책임을 할당하기 위한 가장 기본적인 원칙에 대한 힌트를 제공한다.

크레이그 라만은 **“객체지향 개발에서 가장 중요한 능력은 책임을 능숙하게 소프트웨어 객체에 할당하는 것”** 이라는 이야기로 책임 할당의 중요성을 강조했다.

- 사실 협력이 중요한 이유는 객체에게 할당할 책임을 결정할 수 있는 문맥을제공하기 때문

자율적인 객체를 만드는 가장 기본적인 방법은, 책임을 수행하는 데 **필요한 정보를 가장 잘 알고 있는 전문가에게 그 책임을 할당**하는 것이다. 이를 책임 할당을 위한 **INFORMATION EXPERT(정보 전문가) 패턴**이라고 부른다.

- 객체지향 설계는 협력에 필요한 메시지를 찾고 메시지에 적절한 객체를 선택하는 반복적인 과정을 통해 이뤄진다.
- 그리고 이런 메시지가 메시지를 수신할 객체의 책임을 결정한다.

### 책임 주도 설계

**책임 주도 설계 ( Responsibility-Driven Design, RDD )**

- 책임을 갖고 책임을 수행할 적절한 객체를 찾아 책임을 할당하는 방식으로 협력을 설계하는 방법

**책임 주도 설계 방법의 과정**

- 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악한다.
- 시스템 책임을 더 작은 책임으로 분할한다.
- 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.
- 객체가 책임을 수행하는 도중 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾는다.
- 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 한다.

**메시지가 객체를 결정한다.**

객체가 메시지를 선택하는 것이 아니라 메시지가 객체를 선택하게 한다.

이래야 하는 중요한 두 가지 이유는 다음과 같다.

- 객체가 **최소한의 인터페이스(minimal interface)** 를 가질 수 있게 된다.
- 객체가 충분히 **추상적인 인터페이스(abstract interface)** 를 가질 수 있게 된다.

**행동이 상태를 결정한다.**

- 상태에 초점을 맞추고 설계하면 객체의 내부 구현이 객체의 퍼블릭 인터페이스에 노출되도록 만들기 때문에 캡슐화를 저해한다.
- 이렇게 객체의 내부 구현에 초점을 맞춘 설계 방법을 **데이터-주도 설계(Data-Driven Design)** 라고 부른다.

캡슐화를 위반하지 않도록 구현에 대한 결정을 뒤로 미루면서 객체의 행위를 고려하기 위해서는 항상 협력이라는 문맥 안에서 객체를 생각해야 한다.

## 역할

역할

- 객체가 어떤 특정한 협력 안에서 수행하는 책임의 집합

역할이 중요한 이유는 역할을 통해 유연하고 재사용 가능한 협력을 얻을 수 있기 때문

역할의 구현

- **추상클래스**
    - 역할을 수행할 수 있는 모든 객체들이 공유하는 상태와 행동의 기본 구현이 존재하는 경우
- **인터페이스**
    - 일체 구현 없이 책임의 집합만을 나열할 경우

추상화를 이용한 설계가 가질 수 있는 장점

1. 추상화 계층만을 이용하면 중요한 정책을 상위 수준에서 단순화 할 수 있다
2. 설계가 좀 더 유연해진다.

위 두 가지의 장점은 협력의 관점에서 역할에도 동일하게 적용이 가능하다.

1. 세부 사항에 억눌리지 않고도 상위 수준의 정책을 쉽고 간단하게 표현할 수 있다는 것
2. 설계를 유연하게 가져갈 수 있다. **( 위와 동일 )**
